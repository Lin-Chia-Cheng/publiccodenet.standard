---
order: 12
---
# 使用持續整合

<!-- SPDX-License-Identifier: CC0-1.0 -->
<!-- written in 2019 - 2022 by The Foundation for Public Code <info@publiccode.net> -->

## 需求規範

* [原始碼](../glossary.md#code)中的所有功能都必須有自動化測試。
* 所有貢獻內容都必須先通過自動化測試，才能上傳至[代碼庫](../glossary.md#codebase)。
* 代碼庫必須有說明貢獻內容結構的相關準則。
* 代碼庫必須有活躍貢獻者。
* 代碼庫準則應該規定每次做出貢獻時，都應只聚焦在單一議題上。
* 應該監督原始碼測試與文件的涵蓋範圍。
* 可選擇是否測試[政策](../glossary.md#policy)和文件，與原始碼間有無一致性，或是反之亦然。
* 可選擇是否測試政策和文件所採用的樣式，以及連結有無失效。

## 此措施為何重要

* 使用[持續整合](../glossary.md#continuous-integration)：
   * 可以讓您快速找出代碼庫的問題所在，
   * 能在降低貢獻者面臨壓力的同時，允許承擔風險並且專注在解決問題上，
   * 可降低新貢獻者對整體內容理解的門檻，讓他們更容易提出修改，
   * 讓程式碼更容易維護，
   * 能加速開發週期。
* 修改內容較少、時常提出的貢獻，通常較為容易評估，其風險也低於內容龐大、累積很久才一次提出的變更。
* 活躍開發中的代碼庫較能提供協作與意見回饋的機會。

## 此措施辦不到的事

* 建立能夠順暢作業、可擴展，且能容錯的基礎架構。
* 建立有意義的測試。
* 測試實際會發生的情境。
* 保證交付的程式碼與政策期望的成果確實相同。

## 測試方式

* 確認有測試可用。
* 確認程式碼覆蓋率工具能檢查到 100% 的程式碼。
* 確認貢獻內容只有在通過所有測試後，才會認可上傳至代碼庫。
* 確認有貢獻準則說明貢獻內容的結構。
* 確認最近三個月內有貢獻內容上傳。
* 檢查程式碼覆蓋率數據是否有公布。

## 政策制定者：需要的工作

* 儘早讓管理人員、開發人員與設計師一同加入，並且讓他們持續參與您政策的制定程序。
* 確保政策文件也有設好自動化測試。
* 如果政策文件未能通過測試，請立即修正。
* 確保程式碼能反映出政策的任何變動（請參閱[維護版本控制](version-control-and-history.md)）。

## 管理人員：需要的工作

* 確保能儘快且經常給真正的終端使用者進行測試。
* 以頻繁交付少量部分內容的方式做專案規劃，而非久久一次繳交大量部分內容。
* 聘請有能力處理漸進式交付並跟上規劃進度的顧問服務。
* 發生重大失誤後，鼓勵公開事故報告，以及公開討論事後學到的教訓。

## 開發人員與設計師：需要的工作

* 協助管理階層擬定工作規劃，例如規劃成可以拆分成小部分逐次交付。
* 協助貢獻者聚焦其貢獻內容與功能請求，讓涵蓋範圍盡可能合理地縮小。
* 協助管理人員與政策制定者測試其貢獻內容，例如測試其貢獻內容中的失效連結或樣式。
* 編排程式碼結構時，要將難以在測試環境下創造出來的情況，得以在測試過程中模擬出來。例如硬碟空間不足、記憶體配置失敗等資源耗盡情況，都是難以創造的典型案例。
* 調整程式碼覆蓋率測試工具，避免在 inline 過程或其他最佳化處理時得到假警報。
* 經常部署。
* 至少每天整合工作內容一次。

## 延伸閱讀

* Martin Fowler《[什麼是持續整合](https://www.martinfowler.com/articles/continuousIntegration.html)》。
* Jez Humble《[什麼是持續交付](https://www.continuousdelivery.com/)》。
* 英國政府數位服務團《[使用持續交付](https://gds-way.cloudapps.digital/standards/continuous-delivery.html)》。
* 英國政府數位服務團《[品質保證：定期測試您的服務](https://www.gov.uk/service-manual/technology/quality-assurance-testing-your-service-regularly)》。
